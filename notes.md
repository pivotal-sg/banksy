EventSourcing (our take on ES!) ... some notes on architecture ...

- An aggregate is a representations of an entity, or group of tightly interrelated entities.
- Aggregates may publish events (not dispatch commands)
- dispatcher of a Command receives a CommandResult<T>
- Event Publishing does NOT generate an EventResult<T>
- Communication directly between Aggregates IS ILLEGAL!
- Aggregates apply events after publishing them to the Event Log

# Major components

- **AccountCommandDispatcher**
    - Resposibilities
        - dispatch commands to the AccountService
    - Collaborators
        - AccountService

- **AccountService**
    - Resposibilities
        - Keep Account Aggregates updated
        - Persist new events and apply them to the aggregate
    - Collaborators
        - AccountRepo
        - EventBus
        - EventStore

- **AccountRepository**
    - Resposibilities
        - get/save account aggregate
    - Collaborators
        - AccountAggregate

- **AccountAggregate**
    - Resposibilities
        - validates command
        - apply events

- **AccountQueryService**
    - Resposibilities
        - Forward events to relevant projections
    - Collaborators
        - EventBus

- **QueryDispatcher**
    - Resposibilities
        - route query requests to projections and receive results
    - Collaborators
        - Projections

- **EventStore**
    - Resposibilities
        - Log events
    - Collaborators
        - EventBus

- **EventBus**
    - Resposibilities
        - subscribe events
        - publish events

    - Collaborators
        - Publishers
        - Subscribers

# Spec

- [ ] Create account
    - [ ] Set balance to 0
    - [ ] Get account number in result of command
    - [ ] Indicate success

    - [ ] command is executed
        - [ ] uuid (account number) will be generated by the command
        - [ ] AccountCreated Event is built and published
        - [ ] results are returned to caller

- [ ] View account / balance
    - [ ] Show top level account details

- [ ] Credit Account
    - [ ] Validate positive credit amount
    - [ ] Show success/fail
    - [ ] AccountCredited Event is built and published

- [ ] Debit Account
    - [ ] Validate positive debit amount
    - [ ] Validate within overdraft limit
    - [ ] Show success/fail
    - [ ] AccountDebited Event is built and published

- [ ] Transfer from Account A to Account B
- [ ] ~~Charge monthly interest on Overdraft (at EOM)~~
- [ ] ~~Pay annual interest on credit~~
